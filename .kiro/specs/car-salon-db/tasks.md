# План реализации

- [x] 1. Настройка инфраструктуры и базы данных
  - Настроить Docker Compose с контейнерами для приложения и PostgreSQL
  - Настроить VNC и noVNC для доступа к GUI через браузер
  - Создать Dockerfile с необходимыми зависимостями (Qt5, PostgreSQL client, VNC)
  - _Requirements: 9.1, 9.2, 9.5, 9.6_

- [x] 1.1 Реализовать класс Database для подключения к PostgreSQL
  - Создать файлы database.h и database.cpp
  - Реализовать метод connect() для установки соединения с PostgreSQL
  - Реализовать метод initTable() для создания таблицы cars
  - Реализовать метод getDatabase() для получения экземпляра БД
  - Использовать параметры подключения из переменных окружения
  - _Requirements: 1.1, 1.2, 1.4, 10.4_

- [ ]* 1.2 Написать базовый тест подключения к БД
  - Создать test_database.cpp
  - Написать тест для проверки успешного подключения
  - Написать тест для проверки создания таблицы
  - _Requirements: 1.1, 1.2_

- [x] 2. Реализовать класс Operations для бизнес-логики
  - Создать файлы operations.h и operations.cpp
  - Реализовать метод addCar() для добавления записи
  - Реализовать метод deleteByManufacturer() для удаления по производителю
  - Реализовать метод updatePriceByBrand() для обновления цены
  - Реализовать метод exportToFile() для экспорта данных
  - Реализовать метод readFileContent() для чтения файла
  - Использовать prepared statements для защиты от SQL injection
  - _Requirements: 6.1, 7.1, 8.1, 4.1, 5.1, 10.5, 12.3_

- [x] 2.1 Добавить валидацию входных данных в Operations
  - Реализовать проверку пустых полей
  - Реализовать проверку типов данных (числа, даты)
  - Реализовать проверку бизнес-правил (положительные цены, неотрицательный пробег)
  - Возвращать информативные сообщения об ошибках
  - _Requirements: 6.2, 6.3, 3.2, 8.2, 12.1_

- [ ]* 2.2 Написать базовые тесты для Operations
  - Написать тест для addCar() с валидными данными
  - Написать тест для exportToFile()
  - Написать тест для валидации пустых полей
  - _Requirements: 6.1, 4.1, 6.2_

- [x] 3. Checkpoint - Проверка базовой функциональности
  - Убедиться, что подключение к БД работает
  - Убедиться, что можно добавлять, удалять и обновлять записи через код
  - Убедиться, что экспорт и чтение файлов работает
  - Спросить пользователя, если возникли вопросы

- [x] 4. Создать GUI с использованием Qt
  - Создать файлы mainwindow.h и mainwindow.cpp
  - Создать главное окно приложения (QMainWindow)
  - Добавить QTableView для отображения данных
  - Добавить QSqlTableModel для связи с базой данных
  - Настроить layout с использованием QVBoxLayout и QHBoxLayout
  - _Requirements: 2.1, 2.3, 10.1, 13.1_

- [x] 4.1 Добавить кнопки для всех операций
  - Создать кнопку "Добавить" (btnAdd)
  - Создать кнопку "Удалить по производителю" (btnDelete)
  - Создать кнопку "Обновить цену" (btnUpdate)
  - Создать кнопку "Фильтр по цене" (btnFilter)
  - Создать кнопку "Экспорт в файл" (btnExport)
  - Создать кнопку "Показать файл" (btnShowFile)
  - Создать кнопку "Обновить таблицу" (btnRefresh)
  - Добавить tooltips (подсказки) для каждой кнопки
  - _Requirements: 13.1, 13.2_

- [x] 4.2 Реализовать обработчик добавления записи (onAddCar)
  - Создать диалог для ввода данных (марка, производитель, дата, пробег, цена)
  - Вызвать Operations::addCar() с введенными данными
  - Обновить таблицу после успешного добавления
  - Показать сообщение об ошибке при невалидных данных
  - Показать подтверждение при успехе
  - _Requirements: 6.1, 6.2, 6.3, 6.4, 13.3, 13.4_

- [x] 4.3 Реализовать обработчик удаления (onDeleteByManufacturer)
  - Создать диалог для ввода названия производителя
  - Показать диалог подтверждения удаления
  - Вызвать Operations::deleteByManufacturer()
  - Обновить таблицу после удаления
  - Показать сообщение о количестве удаленных записей
  - _Requirements: 7.1, 7.2, 7.3, 13.4_

- [x] 4.4 Реализовать обработчик обновления цены (onUpdatePrice)
  - Создать диалог для ввода марки и новой цены
  - Вызвать Operations::updatePriceByBrand()
  - Обновить таблицу после обновления
  - Показать сообщение о количестве обновленных записей
  - Обработать ошибки валидации
  - _Requirements: 8.1, 8.2, 8.3, 8.4, 13.4_

- [x] 4.5 Реализовать обработчик фильтрации (onFilterByPrice)
  - Создать диалог для ввода максимальной цены
  - Применить фильтр к QSqlTableModel
  - Показать отфильтрованные данные в таблице
  - Обработать случай отсутствия результатов
  - Добавить возможность сброса фильтра
  - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [x] 4.6 Реализовать обработчик экспорта (onExportToFile)
  - Создать диалог выбора имени файла (QFileDialog)
  - Вызвать Operations::exportToFile()
  - Показать сообщение об успехе с путем к файлу
  - Обработать ошибки записи файла
  - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [x] 4.7 Реализовать обработчик чтения файла (onShowFile)
  - Создать диалог выбора файла (QFileDialog)
  - Вызвать Operations::readFileContent()
  - Показать содержимое файла в QMessageBox или отдельном окне
  - Обработать ошибки чтения файла
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [x] 4.8 Реализовать обработчик обновления таблицы (onRefreshTable)
  - Перезагрузить данные из базы данных
  - Обновить QSqlTableModel
  - Сбросить все фильтры
  - _Requirements: 2.2, 3.4_

- [x] 5. Создать точку входа приложения (main.cpp)
  - Создать QApplication
  - Инициализировать подключение к БД через Database::connect()
  - Создать и инициализировать таблицу через Database::initTable()
  - Создать и показать MainWindow
  - Обработать ошибки подключения к БД
  - _Requirements: 1.1, 1.2, 1.3, 11.1_

- [x] 6. Настроить CMake для сборки проекта
  - Создать CMakeLists.txt с настройками Qt5
  - Добавить поиск пакетов Qt5 (Core, Sql, Widgets)
  - Добавить все исходные файлы в SOURCES
  - Настроить линковку с Qt библиотеками
  - Настроить C++17 стандарт
  - _Requirements: 10.3_

- [ ]* 6.1 Настроить CMake для тестов (опционально)
  - Создать tests/CMakeLists.txt
  - Добавить Qt5::Test
  - Настроить сборку тестовых исполняемых файлов
  - _Requirements: тестирование_

- [x] 7. Финальное тестирование и отладка
  - Запустить приложение в Docker
  - Проверить доступ через браузер (localhost:6080)
  - Выполнить полный цикл операций (добавление, просмотр, фильтрация, экспорт, чтение, обновление, удаление)
  - Проверить обработку ошибок (пустые поля, невалидные данные)
  - Проверить граничные случаи (пустая БД, нет результатов поиска)
  - Убедиться, что данные сохраняются после перезапуска контейнеров
  - _Requirements: все_

- [ ]* 7.1 Запустить автоматические тесты (опционально)
  - Собрать тесты через CMake
  - Запустить test_database
  - Запустить test_operations
  - Убедиться, что все тесты проходят
  - _Requirements: тестирование_

- [ ] 8. Подготовка к защите
  - Подготовить демонстрационные данные (5-10 записей об автомобилях)
  - Проверить, что все 8 функций из задания работают
  - Подготовить сценарий демонстрации
  - Убедиться, что приложение запускается с первого раза
  - Проверить README.md с инструкциями по запуску
  - _Requirements: все_
